### Разработка финансовых приложений

В финансовых приложениях очень много бизнес-логики. И реализовывать её на нетипизированном языке просто стрёмно. К тому же, контора у нас джавистская, поэтому у нас такие приложения пишутся на GWT.

GWT — довольно интересный проект, но вёрстку по умолчанию он генерит ужасающую, да и нормальной шаблонной системы у него нет. Так мы пришли к статическим прототипам.

### Статические прототипы

Статические прототипы — это просто HTML-файлы, которые можно запустить на любой машине, на которой есть браузер.

Да, конечно, количество итераций увеличивается, ведь кому-то в итоге придётся переводить из статики в UIBinder. Но, мне кажется, плюсов у этого подходя гораздо больше:
* Мы вообще отвязываемся от технологии: сегодня там GWT, завтра что-то другое (в не-RIA проектах у нас, например, используются Freemarker-шаблоны)
* Дизайнеры, ПМы и сочувствующие могут увидеть результат раньше: заверстали, написали JS — можно смотреть. Все дизайн-ревью и правки интерактивности можно вносить на этом этапе, не собирая проект целиком
* GWT-разработчики могут просто вставлять куски вёрстки в проект — и он выглядит красиво. Например, у нас в одном из проектов долгое время не было новостей и две выставки подряд мы показывали статические заголовки со статическим описанием, только даты приходилось менять — но их можно было поскролить, покликать, помотреть, какое окошко открывается и т.д.

Проблема в том, что статический прототип одностраничного приложения — это портянка в несколько тысяч строк, с которой не любой diff может справиться.

### Адский код

Получается, что статические прототипы не решают свою задачу. Но сдаваться рано — у нас же есть генераторы статических сайтов!

На настоящий момент я знаю два: Jekyll и Assemble.

Я хочу подробнее оставноиться на Assemble, поскольку он совсем мало освещён. Например, на Хабре про Jekyll что-то находится, а вот по запросу «assemble» получаем статьи про Assembl**y** и Assembl**er**.

### Assemble

Как я уже сказал, Assemble — это генератор статических сайтов. Написан под Node.js, в качестве движка по умолчанию использует Handlebars.

Assemble очень прост в работе — фактически у него всего несколько основных понятий. Если мы говорим о шаблонах — это layout, page, partial.

#### Layout

Файл, на основе которого генерятся страницы. Отличается от всех остальных тем, что в нём обязательно должна быть директива {{> body}} — то место, куда будет вставлено содержимое страницы.

Что ещё важно знать про лейауты:
* можно без них
* могут быть вложенными

#### Page

Собственно, сама страница.

#### Partial

Любой кусок, который вы хотите вынести в отдельный шаблон. Можно ещё назвать словом include.

Вставляется с помощью директивы {{> partial context}}. Если контекст не передать, будет использован текущий. Если же контекст передать, то контекст, переданный в паршл будет урезан и по нему нельзя будет ходить с помощью `../`.

Мы не нашли никакого решения этой проблемы, поэтому написали два хелпера, которые дают нам воркэраунд: один из них сохраняет глобальную область видимости, а другой вызыает паршлы с этой глобальной областью видимости.

#### Helper

Собственно, хелперы. API для них — это встроенный механизм Handlebars для разширения возможностей. У Assemble есть своя большая библиотека хелперов, но если там чего-то не хватает, всегда можно написать свой. Это не сложно.

Важно знать, что хелпер бывают простые (обычно возвращают строку) и блочные (что-то делают с шаблоном, который оборачивают).

#### Data

В качестве данных можно использовать JSON или YAML. Eсть очень удобный механизмз YAML Front Matter, который позволяет задавать какие-то данные прямо в шаблоне страницы.

Кроме того, есть ряд встроенных переменных, таких как `pagename`, `filename`, `ext` и т.д.

