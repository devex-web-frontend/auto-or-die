## ☠ HTML ☠

### Статические прототипы

Мы в компании в процессе разработки используем статические прототипы. Статические прототипы — это просто HTML-файлы, которые можно запустить на любой машине, на которой есть браузер. Не нужен ни сервер, ни сборка, ни деплой.

Плюсы такого подхода:
* Результат виден раньше. Цикл до первого отсмотра значительно сокращается: дизайнеры, аналитики, ПМы могут увидеть как будет выглядеть продукт сразу как только страницу сверстали и добавили немного JS. 
* Серверные pазработчики просто могут просто вставлять куски статической вёрстки в проект — в нём не будет дыр, и он будет выглядеть красиво. (Например, в одном из проектов у нас долго не было данных для одного из блоков и он отлично прожил две выставки в виде куска статического HTML. Продукт хорошо выглядел, в нём не было непонятных пустот.)
* Мы вообще отвязываемся от бэкенд технологии. Внутри команды мы можем использовать единообразный процесс вне зависимости от того, что это за проект. Да, конечно, кому-то придётся переводить статику в UiBinder, Freemarker или что-то ещё.

### Адский код

Но есть и проблемы:
* либо мы получаем неподдерживаемую портянку в несколько тысяч строк, с которой не каждый diff справится — что уж говорить о человеке;
* либо у нас много страничек, которые надо держать в соответствии друг с другом.

Получается, что статические прототипы не решают свою задачу: не упрощают разработку, а наоборот усложняют её.

Но сдаваться рано! Ведь существуют генераторы статических сайтов.
В принципе, их не так много, но они есть. То, что попало в наше поле зрения, мы отсмотрели — и выбрали для себя Assemble. Если вы знаете аналоги, готов с удовольствем обсудить их с вами после доклада.

### Assemble

Как я уже сказал, Assemble — это генератор статических сайтов. В качестве среды он использует Node.js, шаблонный движок по умолчанию — Handlebars. Данные можно передавать в виде JSON или YAML, а на выходе генерить HTML, Markdown, Handlebars и т.д.

Он позволяет создавать небольшие шаблоны — паршлы — а потом из них, как из кирпичиков, собирать HTML-странички. Всё как в вашем любимом серверном шаблонизаторе, за исключением того, что вам не нужен ни Apache, ни Tomcat, ничего. После того, как страница сгенерена, её можно просто открывать в браузере.

В принципе, Assemble очень прост в освоении, и хотя, как и у многих опен-сорс проектов, документация у него страдает — разобраться несложно. Из важных моментов, которые стоит упомянуть:
* он поддерживает YFM: удобные формат задания переменных в YAML формате прямо в коде страницы
* у него есть встроенные переменные: `pagename`, `filename`, `ext` и т.д.
* он очень удобно конфигурируется, в частности есть поле `postprocess`: можно, например, подправить пути к ресурсам

Уже несколько месяцев мы генерим статические прототипы с помощью Assemble и за это время столкнулись лишь с одной крупной сложностью: очень легко потерять ссылку на глобальный контекст. К счастью, у Handlebars есть хелперы — возможность писать вспомогательные директивы на JS — и мы создали воркэраунд:
`{{setGlobalScope}}` и `{{#withGlobalScope}}{{/withGlobalScope}}`.

Конечно же, это не единственные хелперы, которые мы написали. Найти `dx-assemble-helpers` можно на гитхабе.

Вот так, инструмент, который в общем-то придуман не совсем для этого, с помощью воркэраундов и небольшой библиотеки хелперов помогает нам писать код быстрее, делать его более поддерживаемым и, кроме того, оптимизировать связи с другими командами. Ну и чаще испытывать счастье.

Думаю, смерть под завалами HTML нам больше не грозит.
