Управление зависимостями
===

Управление зависимостями во front-end разработке также довольно времязатратная и нетривиальная процедура.

Конечно, если вы пишите простенькие сайты, то все управление зависимостями заканчивается скорее всего на подключении последней стабильной jQuery.

1. Заходим на сайт jQuery
2. Делаем волевой выбор между первой и второй версией jQuery
3. Качаем
4. Подключаем

Вроде никакой проблемы нет.

Если вы хотите писать на чем-нибудь более высокоуровневым, то квест становится сложнее, например, вы хотите подключить Marionette

1. Заходим на сайт
2. Скачиваем
3. Подключаем
4. Ничего не работает
5. Идем докачиваем Backbone
6. Подключаем, запускаем
7. Все равно ничего не работает
8. Идем докачиваем underscore
....

И так далее пока у нас не появятся все зависимости marionette: backbone, несколько backbone плагинов, underscore, jquery.


### Менеджеры пакетов
Так долго продолжаться не могло. И как только стало модно писать веб-приложения с толпой зависимостей, стали появляться различные менеджеры пакетов для веба, которые брали на себя задачу разрешения зависимостей.

В это же время появился и менеджер зависимостей bower, который, в общем-то, единственный и выжил.
Он так же, как и все остальные пакетные менеджеры, хорошо справлялся с задачами менеджера зависимостей:



Bower предоставляет удобное API для добавления зависимостей: либо в секцию dependencies конфигурационного файла вашего проекта (bower.json), либо посредством CLI утилиты.

Bower отлично справляется с задачей решения зависимостей даже для довольно запутанных случаев.

Например, вы подключили ряд зависимостей к своему проекту, эти зависимости, в свою очередь, могут иметь свои зависимости и так далее, сколь угодно глубоко. Нередко возникает ситуация, когда зависимости начинают пересекаться, требуя разные версии одного и того же пакета.

Bower, скорее всего, справится с решением такой задачки автоматически, ну, или в крайнем случае спросит у пользователя, какую версию той или иной библиотеки использовать. И сформирует на выходе плоское дерево зависимостей.

Но самое главное, бовер почти ничего не просит взамен, не накладывает никаких ограничений, что открывает ряд дополнительных возможностей, на которых я хотел бы заострить внимание


Мы стараемся максимально выделять часто повторяющие вещи в переиспользуемые сущности, и поэтому для нас была критична возможность использовать в качестве зависимости не только JS, но и куски верстки, различные миксины и прочие полустатические вещи.

#### Зависимостью может быть что угодно
Мы в разработке выделяем dev-зависимости и prod-зависимости.
dev-зависимости – это полустатические вещи.
prod-зависимости, код который идет в продакшен, как правило, – это различный js код (внешний и внутренний)

В качестве dev-зависимостей мы переиспользуем:
* сторонние js-библиотеки
* внутривенные js-библиотеки
* параметризующиеся styl-файлы для контролов
* переиспользуемые кусочки верстки (partials)
* переиспользуемые хелперы для верстки

Мы также переиспользуем и данные для статических прототипов.

#### Зависимость можно вытащить, откуда угодно
`bower-registry` – огромный регистр, в котором есть все популярные библиотеки

также bower содержит ряд резолверов, позволяющих вытаскивать зависимости, хранящиеся вне регистра
* git репозиторий (таг/ветка, вплоть до коммита)
* прямая ссылка на файл
* прямая ссылка на архив


Однако сначала из коробки не было поддержки SVN-репозиториев. Это нас сперва сильно расстроило, но всего за один день удалось набросать свой простенький SVN-resolver, который поддерживал необходимый нам на тот момент функционал. А именно просто export нужного нам (жестко заданного) тага. Довести до полноценного резолвера (согласно `semver`) руки, к сожалению, так и не дошли. Но все более-менее активные проекты отлично существовали на нашем форке месяца четыре, пока не зарелизили `bower` c поддержкой SVN.


В общем, старайтесь не заниматься копипастой между своими проектами, выделяйте все, что можно в переиспользуемые модули и управляйте ими почти на халяву, ведь все инструменты для этого уже есть.


Перейдём к [тестированию](testing.md).
