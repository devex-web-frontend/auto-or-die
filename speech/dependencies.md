Управление зависимостями
===


****
Цель: убедить аудиторию что управление зависимостями во front-end разработке можно автоматизировать
Идея1: осветить проблемы связанные с переиспользованием различных типов ресурсов внешних и внутренних
Идея2: показать как с этими проблемами справляется бовер
****

###### <заглавный слайд>
Управление зависимостями во front-end разработке также довольно времязатратная и не триваиальная процедура.

Конечно если вы пишите простенькие сайты, то все управление зависимостями заканчивается скорее всего на подключении последней стабильной jQuery. Но и это тоже своеобразный квест.

1. Заходим на сайт jQuery
2. Делаем волевой выбор между первой и второй версией jQuery
3. Качаем
4. Подключаем
5. ...
6. profit

Если вы хотите писать на чемнибудь более высокоуровневым то квест становится на много сложнее, напрмиер вы хотиет подключить Marionette

1. Заходим на сайт
2. Скачиваем
3. Подключаем
4. Ничего не работает
5. Идем докачиваем Backbone
6. Подключаем запускаем
7. Всеравно ничего не работает
8. Идем докачиваем underscore
....

И так далее пока у нас не появятся все зависимости marionette: backbone, несколько backbone плагинов, underscore, jquery.



###### <слайд внешние зависмости>
### Внешние зависимости

В основном говря об управлении зависимостями имееют ввиду внешние зависимости (подключение различных сторонних js-библиотек/фреймворков/шимов).
 

###### <слайд внутренние зависмости>
### Внутренние зависимости

Если компания довольно большая то появляются различные внутренние зависимости:

* Это конечно же внутрикорпаративные библиотечки/кконтролы/виджеты.
* Если проекты компании имеют часто переиспользуемые блоки то возникает желание переиспользовать верстку/стили/миксины чтобы не занмиаться веселой копипастой из проекта в проект.

Все внутренние зависимости обычно легко выкачивать средствами, предоставлемыми принятой в компании системой контроля версий.
С внешними зависмостями все на много сложнее, кто во что горазд:

* git-репозиторий
* svn-репозиторий
* конечный файл
 
Это приводит ко второй проблеме переиспользования front-end ресурсов – **зависмость может находится где угодно**

Подключение высокоуровневых библиотек обычно сопряжено с танцами с бубном вокруг выкачивания определенных версий различных зависимосте и выисивании в документациях поддерживаемых версий.

<слайд засимостью может быть что угодно>

Чтобы не заниматься веселой копипастой из проекта в проект мы стараемся переиспользовать все по максимум: полустатичные dev-ресурсы (styl-файлы, партиалы, данные). Prod-ресурсы различные вешние и внутренние js-библиотеки/фреймворки/шимы
Это приводит к первой проблеме управления зависимостями во front-end разработке – **зависимостью может быть что угодно**


 
### Bower

`Bower` - пакетный менеджер для web-ресурсов, написанный под node.js

### Три преимущества `bower`

#### Зависимостью может быть что угодно
Мы в разработке выделяем dev-зависимости и prod-зависимости.
dev-завимсимости это полустатические вещи.
prod-зависимости код который идет в продкшен, как правило это различный js код (внешний и внутренний)

В качестве dev-зависимостей мы переиспользуем:
* сторонние js-библиотеки
* внутриненние js-библиотеки
* параметризующиеся styl-файлы для контролов
* переиспользуемые кусочки верстки (partials)
* переиспользуемые хелперы для верстки

Мы также переиспользуем и данные для статических прототипов, а иногда и целые проекты.

#### Зависимость можно вытащить, откуда угодно
`bower-registry` – огромный регистр, в котором есть все популярные библиотеки

также bower содержит ряд резолверов позволяющих вытаскивать завимисости хранящиеся вне регистра
* git репозиторий (таг/ветка) вплоть до коммита
* прямая ссылка на файл
* прямая ссылка на архив


Однако, сначала из коробки не было поддержки SVN-репозиториев. Это нас сперва сильно расстроило, но за один день удалось набросать свой простенький SVN-resolver, который поддерживал необходимый нам на тот момент функционал. А именно просто export нужного нам (жестко заданного) тага. Довести до полноценного резолвера (согласно `srmver`) руки, к сожалению, так и не дошли. Но все более-менее активные проекты отлично существовали на нашем форке месяца четыре, пока не зарилизили `bower` c поддержкой SVN.

#### Разрешение зависимостей по `semver`

Указав, один раз, при разработке модуля все его зависимости вам не нужно каждый раз возвращаться и вспоминать "чтоже нужно для его работы". `Bower` сам рекурсивно выкачает все необходимые зависимости. Правильно указав зависимости можно даже долго не спотыкаться на проблемы со стабильностью, но лучше нанести упреждающий удар.


*******************
### Не все так гладко
Не смотря на то что бовер и без того снял много головной боли, осталось еще пара не решенных проблем:

1. подключение javascript на страницу согласно bower дереву зависимостей
2. подключение кастомизируемых js библиотек (таких как `modrnizr`, `jqery 2`)
